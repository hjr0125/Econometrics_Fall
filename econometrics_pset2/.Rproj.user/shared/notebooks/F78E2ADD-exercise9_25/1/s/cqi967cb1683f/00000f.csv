"0","X <- sub_inv %>% "
"0","  select(-year) %>%"
"0","  select(-I) %>% "
"0","  bind_cols(data.frame(con=rep(1,nrow(sub_inv))))"
"0","X <- as.matrix(X)"
"0","Y <- sub_inv %>% "
"0","  select(I)"
"0","Y <- as.matrix(Y)"
"0",""
"0","beta_hat <- solve((t(X) %*% X)) %*% (t(X) %*% Y)"
"0","e_hat <- Y - X %*% beta_hat"
"0",""
"0","XX <- solve((t(X) %*% X)) #XX is variable name it means inverse matrix of (X'X)"
"0","leverage <- diag(X%*%XX%*%t(X))"
"0",""
"0","u3 <- X * ((e_hat/(1-leverage))%*% matrix(1,1,ncol(X)))"
"0","v3 <- XX %*% (t(u3) %*% u3) %*% XX"
"0","s3 <- sqrt(diag(v3))"
