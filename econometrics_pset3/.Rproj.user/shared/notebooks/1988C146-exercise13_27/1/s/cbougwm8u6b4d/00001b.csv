"0","Y <- as.matrix(ajr$loggdp)"
"0","X <- as.matrix(ajr %>% "
"0","                 select(risk) %>% "
"0","                 bind_cols(data.frame(con=rep(1,nrow(ajr)))))"
"0","X.endo <- X[,1]"
"0","X.exo <- X[,2]"
"0","Z <- as.matrix(ajr %>% "
"0","                 select(logmort0) %>%"
"0","                 mutate(logmort0sq = logmort0^2) %>% "
"0","                 bind_cols(data.frame(con=rep(1,nrow(ajr)))))"
"0",""
"0",""
"0",""
"0","b2sls <- solve(t(X)%*%Z%*%solve(t(Z)%*%Z)%*%t(Z)%*%X)%*%t(X)%*%Z%*%"
"0","  solve(t(Z)%*%Z)%*%t(Z)%*%Y"
"0","e_hat2sls <- Y - X %*% b2sls"
"0",""
"0",""
"0","w <- Z*(e_hat2sls%*%matrix(1,1,ncol(Z)))"
"0","O <- t(w)%*%w"
"0",""
"0","bgmm <- solve(t(X)%*%Z%*%solve(O)%*%t(Z)%*%X)%*%(t(X)%*%Z%*%solve(O)%*%t(Z)%*%Y)"
"0","vgmm <- solve((t(X)%*%Z)%*%solve(O)%*%(t(Z)%*%X))"
"0","segmm <- sqrt(diag(vgmm))"
