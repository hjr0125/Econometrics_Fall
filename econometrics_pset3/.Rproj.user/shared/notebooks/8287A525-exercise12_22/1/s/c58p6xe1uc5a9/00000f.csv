"0","Y <- as.matrix(ajr$loggdp)"
"0","X <- as.matrix(ajr %>% "
"0","                 select(risk) %>% "
"0","                 bind_cols(data.frame(con=rep(1,nrow(ajr)))))"
"0","beta_hat <- solve((t(X) %*% X)) %*% (t(X) %*% Y)"
"0","e_hat <- Y - X %*% beta_hat"
"0","row.names(beta_hat) <- c('risk','intercept')"
"0","colnames(beta_hat) <- c('coefficient')"
"0","colnames(e_hat) <- c('error')"
"0","XX <- solve((t(X) %*% X)) #XX is variable name it means inverse matrix of (X'X)"
"0","leverage <- diag(X%*%XX%*%t(X))"
"0","u3 <- X * ((e_hat/(1-leverage))%*% matrix(1,1,ncol(X)))"
"0","v3 <- XX %*% (t(u3) %*% u3) %*% XX"
"0","s3 <- sqrt(diag(v3))"
