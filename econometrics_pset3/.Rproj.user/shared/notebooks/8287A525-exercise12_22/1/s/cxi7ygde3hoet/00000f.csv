"0","#| warning: FALSE"
"0","sig2_1 <- as.numeric((t(e_hat)%*%e_hat)/(nrow(Y)-ncol(X))) #sigma for ols"
"0","sig2_2 <- as.numeric((t(e_hatr)%*%e_hatr)/(nrow(Yr)-ncol(Xr))) #sigma for first-stage"
"0","sig2_3 <- as.numeric((t(e_hat2sls)%*%e_hat2sls)/(nrow(Y)-ncol(X))) #sigma for 2sls"
"0",""
"0","v0_1 <- XX*sig2_1 #variance for ols"
"0","v0_2 <- XXr*sig2_2 #variance for first-stage"
"0","v0_3 <- solve(t(qzx)%*%solve(qzz)%*%qzx)%*%t(qzx)%*%solve(qzz)%*% #variance for 2sls"
"0","  solve(qzz)%*%qzx%*%solve(t(qzx)%*%solve(qzz)%*%qzx)*sig2_3"
"0",""
"0",""
"0","s0_1 <- diag(sqrt(v0_1))"
"0","s0_2 <- diag(sqrt(v0_2))"
"0","s0_3 <- diag(sqrt(v0_3))"
"0",""
"0",""
"0","result_d <- data.frame('homoskedastic'=c(s0_1[1],s0_2[1],s0_3[1]),"
"0","                       'heteroskedastic'=c(s3[1],s3r[1],se2[1,]),"
"0","                       'reports from paper' =c(0.06,0.13,0.16),"
"0","                       row.names = c('ols','first-stage','2sls'))"
